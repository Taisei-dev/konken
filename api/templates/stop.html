<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="format-detection" content="telephone=no">
<title></title>
<link rel="apple-touch-icon-precomposed" href="/img/appicon.png">
<link rel="stylesheet" href="../css/autocomplete.css" media="all">
<link rel="stylesheet" href="../css/import.css" media="all">
<!--<link rel="stylesheet" href="/common/css/fonts.css" media="all">-->
<link rel="stylesheet" href="../css/fonts.css" media="all">
<link type="text/css" rel="stylesheet" href="../ui/1.10.3/themes/cupertino/jquery-ui.min.css" />
<link href="../img/favicon.ico" rel="shortcut icon" />
<link rel="icon" href="/img/appicon.png">
<link rel="apple-touch-icon-precomposed" href="/img/appicon.png">
<script src="../jquery-1.10.2.min.js"></script>
<script src="../ui/1.10.3/jquery-ui.min.js"></script>
<script async src="../js/trunk2.js"></script>
<script async src="../js/busit-general.js"></script>
<script async src="../js/height.js"></script>
<!--[if lt IE 9]>
<script src="/js/html5shiv.js"></script>
<![endif]-->

<script async=“async” src="../client/towncreation/flux_busit_AS_PB_AT.min.js" type="text/javascript"></script>
<script type="text/javascript">
var pbjs = pbjs || {};
pbjs.que = pbjs.que || [];
</script>

</head>
<body>

    <!--言語切り替え-->
<section class="modal-window" id="modal-p01">
    <div class="modal-inner">
        <p>Change Language</p>
        <ul>
                            <li><a class="" href="/stop/0001001?lang=ja">日本語</a></li>
                            <li><a class="check" href="/stop/0001001?lang=en">English</a></li>
                            <li><a class="" href="/stop/0001001?lang=ko">&#54620;&#44397;&#50612;</a></li>
                            <li><a class="" href="/stop/0001001?lang=zh_CN">&#x4E2D;&#x6587;&#xFF08;&#x7B80;&#x4F53;&#xFF09;</a></li>
                            <li><a class="" href="/stop/0001001?lang=zh_TW">&#x4E2D;&#x6587;&#xFF08;&#x7E41;&#x9AD4;&#xFF09;</a></li>
                    </ul>
    </div>
    <a href="#!" class="modal-close"></a>
</section>
<!--/言語切り替え-->
    <div class="mask slide"></div>

    <div class="fav">
        <div class="fav-inner">
            <p class="on">お気に入りに追加しました</p>
            <p class="no">お気に入りを解除しました</p>
            <a href="#" class="close">閉じる</a>
        </div>
    </div>

    <!--のりば切り替え-->
    <section class="modal-window" id="modal-p02">
        <div class="modal-inner">
            <p>のりば切り替え</p>
            <div class="modal-scroll">
                <div>
                    <a href="/stop/0001050">
                            広島バスセンター<br />
                            Hiroshima Bus Center<br />
                            for drop only, Hiroshima Sta.
                    </a>
            </div>
            </div>
        </div>
        <a href="#!" class="modal-close"></a>
    </section>
    <!--/のりば切り替え-->
    <!--/臨時便-->
    <section class="modal-window extraBuses-window" id="modal-p03">
        <div class="modal-inner">
            <p class="extraBuses-title">ただいま運行中の臨時便</p>
            <div class="modal-scroll stopBusBox01 type01">
                            </div>
            <a href="#!" class="foot"><p>閉じる</p></a>
        </div>
        <a href="#!" class="modal-close"></a>
    </section>
    <!--/臨時便-->

    <div id="container">
        <header class="slide">
            <div id="header">
            <h1 id="ttl"><a href="/" ><img src="../img/common/logo.png" width="120" alt="バスイット"></a></h1>
                <p id="favorite">
            <a href="javascript:void(0)" onclick="favorite('0001001')" title="お気に入り">
                <span style="height: 25px; overflow: hidden; display: block;">
                                            <img src="../img/common/icon_favo.png" width="35" height="35" alt="お気に入り" style="margin: -2px auto 0;text-align: center;display: block;">
                                    </span>				
                <span style="font-size: 11px;color: #fff;display: inline-block;">お気に入り</span>
            </a>
        </p>
        <p id="language"><a href="#modal-p01">Lang</a></p>
    <p class="menu"><img src="../img/common/icon_navi.png" width="45" height="45" id="navToggle" class="burger slide" alt=""></p>
</div>
        </header>
        <nav class="slide">
    <ul>
        <li class="navttl"><img src="../img/common/logo-top.png" alt="BUSit-バスイット"></li>
        <li><a href="/favorite/?StopID=0001001"><i class="icon icon-star"></i>お気に入り</a></li>
                    <li><a href="/history/?stop_id=0001001"><i class="icon icon-time"></i>履歴</a></li>
                                                            <li><a href="/stop/map/0001001"><i class="icon icon-map"></i>地図を見る</a></li>
                            <li><a href="/search/on?stop_id=0001001&amp;latlon=34.396353%2C132.455824"><i class="icon icon-search"></i>バス停検索</a></li>
                <li><a href="/ptimetable/0001001"><i class="icon icon-bus"></i>各バス会社リンク先</a></li>
        <li><a href="/feedback/stop/0001001"><i class="icon icon-report"></i>問題を報告</a></li>
        <li><a href="/stop/guide/0001001"><i class="icon icon-beginner"></i>使い方</a></li>
        <li><a href="/stop/disclaimer/0001001"><i class="icon icon-guide"></i>Disclaimer</a></li>
        <!-- <li><a href="https://www.towncreation.com/product/busit-ad/stop_ad/" target="_blank"><i class="icon icon-image"></i>広告募集</a></li> -->
    </ul>
</nav><!--/drawer-->
        <div class="content slide">
            <section>
                <div id="bstop_ttlBox">
                    <!--バス停名-->
                    <div id="area">
                        <p class="mark">1</p>
                        <div class="busStopName" itemscope itemtype="http://schema.org/BusStop">
                            <span class="bstop_furi" itemprop="name"></span><span class="bstop_name" itemprop="name"></span><span class="bstop_furi" itemprop="alternateName"></span>
                        </div>
                    </div>
                    <!--/バス停名-->

                    <div id="bstop_control" class="clearfix">
                        <!--目的地設定-->
                        <p class="goal">目的地:<a href="/search/to/0001001">未設定</a></p>
                        <!--/目的地設定-->
                        <!-- 更新 -->
                        <p class="update"><a onclick="window.location.reload()"><i class="icon icon-update"></i>更新</a></p>
                        <!--のりば切り替え-->
                        <p class="change"><a href="#modal-p02"><i class="icon icon-change"></i>のりば切り替え</a></p>
                        <!--/のりば切り替え-->
                    </div><!--/bstop_control-->

                </div>
                <!--到着バス・所要時間-->
                <div class="stopBusBox01 type01">
                    <ul>

                    </ul>
                    <p class="btnMore">もっとみる(次の10件を表示)</p>
                    <p class="overFlow" style="visibility: hidden">以上で本日の運行は終了です。</p>
                </div>
                <!--/到着バス・所要時間-->
            </section>
        </div>
    </div>
    
    <script async type="text/javascript" src="../js/favorite.js"></script>
    <script type="text/javascript">
        /**
         * お気に入り登録/解除
         */
        function favorite(stopId) {
            $.ajaxSetup({
                headers: {
                    'X-CSRF-TOKEN': "8c9a83b26f39c6bafe54afdfba6f8d2729f936e9600ac5e84c72c0f155248a25f07075d078d4c0522a121c1e37694c095a6af06a03e6d8ed24ac72b4deb10ae4"				}
            });
            $.post(
                '/stop/favorite/add/0001001',
                {
                    'stopId': stopId
                },
                function (data, status) {
                    $('#favorite a').html(data);
                },
                "html"
            );
        }


    </script>
    <script type="text/javascript">
        /**
         * 次の x 件表示
         * 操作対象の html よりも前に記述すること
         * 後に記述すると非表示の要素が一瞬表示されてしまう
         */
        $(function () {
            var $c = 10;
            var $s = 0;
            var $e = $c;
            $shownext = function () {
                $('.buscard').slice($s, $e).css('display', 'block');
                $s = $e;
                $e = $s + $c;
                if ($('.buscard').slice($s, $e).length < 1) {
                    $('.btnMore').hide();
                    $('.overFlow').css('visibility', 'visible');
                }
            };
            $('.buscard').css('display', 'none');
            $shownext();
            $('.btnMore').on('click', function () {
                $shownext();
            });
        });
    </script>
    <div id="kurukendata" style="display:none">
    {{ response | safe }}
    </div>
    <script>
        var data=document.querySelector("#kurukendata");
        var stationname=document.querySelector('p.resultSekkinStationName').innerText;
        if(stationname.search('：')!=-1){
            document.querySelector('span.bstop_name').innerText=stationname.substring(0,stationname.search('：')-1);
            document.title=document.querySelector('span.bstop_name').innerText+' のりば'+document.querySelector('#area p.mark').innerText;
            document.querySelector('#area p.mark').innerText=stationname.substr(stationname.search('：')+1,stationname.length-1);
        }
        else{
            document.querySelector('span.bstop_name').innerText=stationname;
            document.title=document.querySelector('span.bstop_name').innerText;
            document.querySelector('#area p.mark').style.display='none';
        }
        var parent=document.querySelector('div.stopBusBox01 ul');
        var imgbycomid={"bus-73086101":3,"bus-73008250":4,"bus-73385130":5,"bus-73385140":6,"bus-73308150":7,"bus-72700110":8,"bus-73900430":9,"bus-73208220":10,"bus-73805130":13,"bus-73885010":29,"bus-73785010":39,}
        var trips=document.querySelectorAll('#approach_list_for_daiya li.approachDtlCard');
        trips.forEach(trip=>{
            var li=document.createElement('li');
            li.classList.add('buscard');
            li.innerHTML='<div class="head">'+
                        '   <p class="time" itemprop="departureTime">'+trip.querySelector('td.Time').innerText+'</p>'+
                        '   <p class="status">'+(trip.querySelector('div.changeCourseInner span.arrivedAboutMinPre')?('約'+trip.querySelector('div.changeCourseInner').innerText+'分で到着'):trip.querySelector('div.changeCourseInner').innerText)+'</p>'+
                        '</div>'+
                        '<div class="iconGroup">'+
                        '   <p>'+'<!--<span class="incompatible">バスロケ未受信</span>-->'+(trip.querySelector('td.BusType div.NonStep')?'<span class="nonStep">ノンステップ</span>':'')+(trip.querySelector('td.BusType div.OneStep')?'<span class="oneStep">ワンステップ</span>':'')+(trip.querySelector('td.BusSlope div.none')?'':'<span class="nonStep">スロープ</span>')+'<!--<span class="extraordinary">臨時便</span>-->'+'</p>'+
                        '</div>'+
                        '<div class="btm">'+
                        '   <p class="company">'+'<img src="../img/bus/icon_'+imgbycomid[trip.classList[0]]+'.png" width="44"/>'+'</p>'+
                        '   <div class="bordBox">'+
                        '       <div class="inBox">'+
                        '           <p class="num">'+trip.querySelector('td.KeitouNo').innerText+'</p>'+
                        '           <p class="destination">'+
                        '               <a href="javascript:void(0)">'+
                        '                   <span class="route">'+(trip.querySelector('div.IkisakiKeiyuName')?trip.querySelector('div.IkisakiKeiyuName').innerText:'')+'</span>'+
                        '                   <span class="terminal">'+trip.querySelector('td.CourseGroupName a').innerText+'</span>'+
                        '               </a>'+
                        '           </p>'+
                        '       </div>'+
                        '   </div>'+
                        '</div>';
            li.querySelector('p.destination a').href='javascript:'+trip.querySelector('td.CourseGroupName a').onclick.toString().slice(26.-2);
            if(trip.querySelector('div.changeCourseInner span.arrivingSoon')||trip.querySelector('div.changeCourseInner span.arrivingDoorOpen')||trip.querySelector('div.changeCourseInner span.arrivingTargetStation')){
                li.classList.add('soon');
            }
            parent.appendChild(li);
        });
        function resultByCourse(stationSid, courseSid, companyId, busId, keiyuCd, daiyaSid, courseNo, ikisakiName, ikisakiKeiyuName, displayCompanyId, teikokuTime, redraw) {
            window.location.href='/trip?daiyasid='+daiyaSid+'&stationsid='+stationSid;
        }
    </script>
</body>
</html>
